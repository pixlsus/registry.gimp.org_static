<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML+RDFa 1.0//EN"
  "http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" version="XHTML+RDFa 1.0" dir="ltr">

<head profile="http://www.w3.org/1999/xhtml/vocab">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../files/favicon.png" type="image/png" />
<link rel="alternate" type="application/rss+xml" title="Comments for &quot;Divide Scanned Images&quot;" href="../crss/node/22177" />
<link rel="canonical" href="22177" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
<link rel="shortlink" href="22177" />
  <title>Divide Scanned Images | GIMP Plugin Registry</title>
  <style type="text/css" media="all">@import url("../modules/system/system.base.css?n48fl6");
@import url("../modules/system/system.menus.css?n48fl6");
@import url("../modules/system/system.messages.css?n48fl6");
@import url("../modules/system/system.theme.css?n48fl6");</style>
<style type="text/css" media="all">@import url("../modules/aggregator/aggregator.css?n48fl6");
@import url("../modules/book/book.css?n48fl6");
@import url("../modules/comment/comment.css?n48fl6");
@import url("../sites/all/modules/date/date_api/date.css?n48fl6");
@import url("../sites/all/modules/date/date_popup/themes/datepicker.1.7.css?n48fl6");
@import url("../sites/all/modules/date/date_repeat_field/date_repeat_field.css?n48fl6");
@import url("../modules/field/theme/field.css?n48fl6");
@import url("../sites/all/modules/mollom/mollom.css?n48fl6");
@import url("../modules/node/node.css?n48fl6");
@import url("../modules/poll/poll.css?n48fl6");
@import url("../modules/search/search.css?n48fl6");
@import url("../modules/user/user.css?n48fl6");
@import url("../modules/forum/forum.css?n48fl6");
@import url("../sites/all/modules/views/css/views.css?n48fl6");</style>
<style type="text/css" media="all">@import url("../sites/all/modules/ctools/css/ctools.css?n48fl6");
@import url("../sites/all/modules/rate/rate.css?n48fl6");
@import url("../sites/all/modules/tagclouds/tagclouds.css?n48fl6");
@import url("../sites/all/modules/panels/css/panels.css?n48fl6");
@import url("../sites/all/modules/best_answer/best_answer.css?n48fl6");
@import url("../sites/all/modules/rate/templates/fivestar/fivestar.css?n48fl6");</style>
<style type="text/css" media="all">@import url("../files/color/garland-5ac73a91/style.css?n48fl6");</style>
<style type="text/css" media="print">@import url("../themes/garland/print.css?n48fl6");</style>

<!--[if lt IE 7]>
<link type="text/css" rel="stylesheet" href="http://registry.gimp.org/themes/garland/fix-ie.css?n48fl6" media="all" />
<![endif]-->
  <script type="text/javascript" src="../misc/jquery.js?v=1.4.4"></script>
<script type="text/javascript" src="../misc/jquery.once.js?v=1.2"></script>
<script type="text/javascript" src="../misc/drupal.js?n48fl6"></script>
<script type="text/javascript" src="../sites/all/modules/rate/rate.js?n48fl6"></script>
<script type="text/javascript" src="../sites/all/modules/rate/templates/fivestar/fivestar.js?n48fl6"></script>
<script type="text/javascript" src="../misc/tableheader.js?n48fl6"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"garland","theme_token":"LW8AznViqYvIZXMOm9f5ccYtBFKRwaD354VfGF_o-IA","js":{"misc\/jquery.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/modules\/rate\/rate.js":1,"sites\/all\/modules\/rate\/templates\/fivestar\/fivestar.js":1,"misc\/tableheader.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/aggregator\/aggregator.css":1,"modules\/book\/book.css":1,"modules\/comment\/comment.css":1,"sites\/all\/modules\/date\/date_api\/date.css":1,"sites\/all\/modules\/date\/date_popup\/themes\/datepicker.1.7.css":1,"sites\/all\/modules\/date\/date_repeat_field\/date_repeat_field.css":1,"modules\/field\/theme\/field.css":1,"sites\/all\/modules\/mollom\/mollom.css":1,"modules\/node\/node.css":1,"modules\/poll\/poll.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"modules\/forum\/forum.css":1,"sites\/all\/modules\/views\/css\/views.css":1,"sites\/all\/modules\/ctools\/css\/ctools.css":1,"sites\/all\/modules\/rate\/rate.css":1,"sites\/all\/modules\/tagclouds\/tagclouds.css":1,"sites\/all\/modules\/panels\/css\/panels.css":1,"sites\/all\/modules\/best_answer\/best_answer.css":1,"sites\/all\/modules\/rate\/templates\/fivestar\/fivestar.css":1,"themes\/garland\/style.css":1,"themes\/garland\/print.css":1,"themes\/garland\/fix-ie.css":1}},"rate":{"basePath":"\/rate\/vote\/js","destination":"node\/22177"}});
//--><!]]>
</script>
</head>
<body class="html not-front not-logged-in two-sidebars page-node page-node- page-node-22177 node-type-scriptfu fluid-width" >
  <div id="skip-link">
    <a href="22177?page=1#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
      
  <div id="wrapper">
    <div id="container" class="clearfix">

      <div id="header">
        <div id="logo-floater">
                              <div id="branding"><strong><a href="../index.html">
                          <img src="../files/logo.png" alt="GIMP Plugin Registry " title="GIMP Plugin Registry " id="logo" />
                        <span>GIMP Plugin Registry</span>            </a></strong></div>
                          </div>

        <h2 class="element-invisible">Main menu</h2><ul class="links inline main-menu"><li class="menu-100 first"><a href="../about" title="Information about the Registry">About</a></li>
<li class="menu-136"><a href="23851" title="Documentation and How-Tos">Documentation</a></li>
<li class="menu-88"><a href="../forum">Forums</a></li>
<li class="menu-74"><a href="http://gug.criticalhit.dk" title="The GIMP User Group">GIMP User Group</a></li>
<li class="menu-1142"><a href="25574" title="GIMP Help">Get Help</a></li>
<li class="menu-1256"><a href="26216" title="Get info on using RSS to stay updated about what&#039;s going on on the site.">Stay Updated!</a></li>
<li class="menu-73 last"><a href="http://www.gimp.org/" title="The GIMP Homepage">gimp.org</a></li>
</ul>              </div> <!-- /#header -->

              <div id="sidebar-first" class="sidebar">
            <div class="region region-sidebar-first">
    <div id="block-system-navigation" class="block block-system block-menu clearfix">

    <h2 class="title">Navigation</h2>
  
  <div class="content">
    <ul class="menu"><li class="first leaf"><a href="25574" title="FAQ &amp; How To&#039;s">FAQ &amp; How To&#039;s</a></li>
<li class="leaf"><a href="../glossary.1" title="">Content By Name</a></li>
<li class="collapsed"><a href="../aggregator">Feed aggregator</a></li>
<li class="leaf"><a href="../popular">Popular content</a></li>
<li class="leaf"><a href="25392" title="Report Spam Here">Report Spam Here</a></li>
<li class="last leaf"><a href="../tagclouds">Tags</a></li>
</ul>  </div>
</div>
<div id="block-block-1" class="block block-block clearfix">

    
  <div class="content">
    If you'd like to upload plug-ins, please create an account below. You do <em>not</em> need one for download. Enjoy :-)  </div>
</div>
<div id="block-user-login" class="block block-user clearfix">

    <h2 class="title">User login</h2>
  
  <div class="content">
    <form action="http://registry.gimp.org/node/22177?destination=node/22177" method="post" id="user-login-form" accept-charset="UTF-8"><div><div class="form-item form-type-textfield form-item-name">
  <label for="edit-name">Username <span class="form-required" title="This field is required.">*</span></label>
 <input type="text" id="edit-name" name="name" value="" size="15" maxlength="60" class="form-text required" />
</div>
<div class="form-item form-type-password form-item-pass">
  <label for="edit-pass">Password <span class="form-required" title="This field is required.">*</span></label>
 <input type="password" id="edit-pass" name="pass" size="15" maxlength="128" class="form-text required" />
</div>
<div class="item-list"><ul><li class="first last"><a href="../user/password" title="Request new password via e-mail.">Request new password</a></li>
</ul></div><input type="hidden" name="form_build_id" value="form-TcU50__eafsaYPRl8rqEgiCniaxKFjj14g-q6MiCFsU" />
<input type="hidden" name="form_id" value="user_login_block" />
<div class="form-actions form-wrapper" id="edit-actions"><input type="submit" id="edit-submit" name="op" value="Log in" class="form-submit" /></div></div></form>  </div>
</div>
<div id="block-node-syndicate" class="block block-node clearfix">

    <h2 class="title">Syndicate</h2>
  
  <div class="content">
    <a href="../rss.xml" class="feed-icon" title="Subscribe to Syndicate"><img src="../misc/feed.png" width="16" height="16" alt="Subscribe to Syndicate" /></a>  </div>
</div>
  </div>
        </div>
      
      <div id="center"><div id="squeeze"><div class="right-corner"><div class="left-corner">
          <h2 class="element-invisible">You are here</h2><div class="breadcrumb"><a href="../index.html">Home</a></div>                    <a id="main-content"></a>
          <div id="tabs-wrapper" class="clearfix">                                <h1 class="with-tabs">Divide Scanned Images</h1>
                              </div>                                                  <div class="clearfix">
              <div class="region region-content">
    <div id="block-system-main" class="block block-system clearfix">

    
  <div class="content">
    <div id="node-22177" class="node node-scriptfu node-promoted">

  
      
      <span class="submitted">January 11, 2010 - 23:17 — <span class="username">ffaat</span></span>
  
  <div class="content clearfix">
    <div class="form-item form-type-item">
  <label>Rate </label>
 <div class="rate-widget-2 rate-widget clear-block rate-average rate-widget-fivestar rate-694d77ca1a29481501aa362362327aa7 rate-node-22177-2-3" id="rate-node-22177-2-3"><div class="item-list"><ul><li class="first"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-1" id="rate-button-1">1</span></li>
<li><span class="rate-button rate-fivestar-btn-empty rate-fivestar-2" id="rate-button-2">2</span></li>
<li><span class="rate-button rate-fivestar-btn-empty rate-fivestar-3" id="rate-button-3">3</span></li>
<li><span class="rate-button rate-fivestar-btn-empty rate-fivestar-4" id="rate-button-4">4</span></li>
<li class="last"><span class="rate-button rate-fivestar-btn-empty rate-fivestar-5" id="rate-button-5">5</span></li>
</ul></div><div class="rate-info">Total votes: 0</div><div class="rate-description">Rate this item!</div></div>
</div>
<div class="field field-name-upload field-type-file field-label-hidden"><div class="field-items"><div class="field-item even"><table class="sticky-enabled">
 <thead><tr><th>Attachment</th><th>Size</th> </tr></thead>
<tbody>
 <tr class="odd"><td><span class="file"><img class="file-icon" alt="" title="application/octet-stream" src="../modules/file/icons/application-octet-stream.png" /> <a href="../files/DivideScannedImages.scm" type="application/octet-stream; length=14520" title="DivideScannedImages.scm">DivideScannedImages.scm</a></span></td><td>14.18 KB</td> </tr>
 <tr class="even"><td><span class="file"><img class="file-icon" alt="" title="application/zip" src="../modules/file/icons/package-x-generic.png" /> <a href="../files/deskew.zip" type="application/zip; length=22125" title="deskew.zip">deskew.zip</a></span></td><td>21.61 KB</td> </tr>
</tbody>
</table>
</div></div></div><div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even"><p>A script that will detect multiple images within a single image, crop them, optionally straighten them, and save them out with incrementing filenames+numbers.  It was developed to aid in separating photos scanned on a flatbed scanner as one "image".</p>
<p>There is a big discussion thread over at gimptalk on this: <a href="http://www.gimptalk.com/forum/viewtopic.php?f=9&amp;t=36438">http://www.gimptalk.com/forum/viewtopic.php?f=9&amp;t=36438</a></p>
<p>The script also provides a batch mode to process a while directory of scanned images pages.</p>
<p>Note that the straightening will only work if you have the deskew plugin installed: <a href="http://www.cubewano.org/gimp-deskew-plugin/">http://www.cubewano.org/gimp-deskew-plugin/</a></p>
<p>***Since this site is down, i have attached a windows precompiled binary of the deskew plugin for convenience.</p>
</div></div></div><div class="field field-name-taxonomy-vocabulary-7 field-type-taxonomy-term-reference field-label-inline clearfix"><div class="field-label">Code License:&nbsp;</div><div class="field-items"><div class="field-item even"><a href="../taxonomy/term/43">GPLv2+</a></div></div></div><div class="field field-name-taxonomy-vocabulary-5 field-type-taxonomy-term-reference field-label-inline clearfix"><div class="field-label">Tags:&nbsp;</div><div class="field-items"><div class="field-item even"><a href="../taxonomy/term/59">save</a></div><div class="field-item odd"><a href="../taxonomy/term/649">multiple</a></div><div class="field-item even"><a href="../taxonomy/term/926">divide</a></div><div class="field-item odd"><a href="../taxonomy/term/927">scanned</a></div><div class="field-item even"><a href="../taxonomy/term/928">seperate</a></div></div></div><div class="field field-name-taxonomy-vocabulary-1 field-type-taxonomy-term-reference field-label-inline clearfix"><div class="field-label">GIMP Version:&nbsp;</div><div class="field-items"><div class="field-item even"><a href="../taxonomy/term/523">2.6</a></div></div></div><div class="field field-name-taxonomy-vocabulary-3 field-type-taxonomy-term-reference field-label-inline clearfix"><div class="field-label">Scripting Engine:&nbsp;</div><div class="field-items"><div class="field-item even"><a href="../taxonomy/term/20">Script-Fu</a></div></div></div>  </div>

  <div class="clearfix">
          <div class="links"><ul class="links inline"><li class="comment_forbidden first last"><span><a href="../user/login?destination=comment%252Freply%252F22177%2523comment-form">Log in</a> to post comments</span></li>
</ul></div>
    
    <div id="comments" class="comment-wrapper">
  
          <h2 class="title">Comments</h2>
      
  <a id="comment-16364"></a>
<div class="comment odd">

  <div class="clearfix">

    <span class="submitted">January 5, 2013 - 15:00 — <span class="username">Manu G</span></span>

  
  
        <h3><a href="../comment/16364#comment-16364" class="permalink" rel="bookmark">Scanned images: frequent usage problems</a></h3>
    
    <div class="content">
      <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>If you google this Batch tool for separating scanned photos in one A4, there are a lot of literature but few solutions really effective. And this is the one that REALLY works. I have to say thanks, but also propose the script should have a README explaining inside out how to twick the options menu when using this script. I play around and discover the importance of 3 things:<br />
1) Background sample tries to find the color of the background. So I have sorted out the source images depending on which corner is the white background<br />
2) Abort Limit: I set it up to 85 and still results were good. No clear to me what is this for<br />
3) Results: major issue is this script does not slide images that are scanned touching the scanner border, since this border is not same color as background. The advantage of a batch scanning is the ability to use the four borders of the scanner to align photos and avoid skew step. To solve this issue I used PHATCH IMAGE PROCESSOR to a) cut 5 pixels of the whole batch of A4 scanned images b) Add 25 pixels of the same color of my background c) save as PNG. Note: To measure the color of the background I used GIMP pick color option in "tools". I successfully run the script later.<br />
Another frequent error when scanning is to scan a photo twice or simply scan several copies of the same photo. For detecting Duplicates you can use DIGIKAM. Tools-Find Duplicates.<br />
I congratulate but also encourage the script owner to include at least point 3 as an option in the script code. Many thanks</p>
</div></div></div>          </div>
  </div>

  <ul class="links inline"><li class="comment_forbidden first last"><span><a href="../user/login?destination=comment%252Freply%252F22177%2523comment-form">Log in</a> to post comments</span></li>
</ul></div>
<a id="comment-16078"></a>
<div class="comment even">

  <div class="clearfix">

    <span class="submitted">November 18, 2012 - 16:40 — <span class="username">Abdull</span></span>

  
  
        <h3><a href="../comment/16078#comment-16078" class="permalink" rel="bookmark">Interactive cropping</a></h3>
    
    <div class="content">
      <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>This is a great script, and it works most of the time for me. I have a suggestion for just another cropping mode: "pre-selected cropping and saving".<br />
The user has opened his "multiple-small-images" image. Then he selects several small images with the bounding box tool, holding Shift each time he adds an additional small image. After selection is finished, the user now runs the runs the "Pre-selected cropping and saving" script. Each bounding box is exported to an image, with automatic file name creation (e.g. image001.jpg, image002.jpg, image003.jpg ...)</p>
</div></div></div>          </div>
  </div>

  <ul class="links inline"><li class="comment_forbidden first last"><span><a href="../user/login?destination=comment%252Freply%252F22177%2523comment-form">Log in</a> to post comments</span></li>
</ul></div>
<a id="comment-15709"></a>
<div class="comment odd">

  <div class="clearfix">

    <span class="submitted">October 12, 2012 - 18:46 — <span class="username">Colin W</span></span>

  
  
        <h3><a href="../comment/15709#comment-15709" class="permalink" rel="bookmark">Gimp 2.8</a></h3>
    
    <div class="content">
      <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Installation Notes for Gimp 2.8:</p>
<p>The scripts folder has moved slightly in Gimp 2.8 (on OS X Mountain Lion).  You can see where your scripts folder is by going to Preferences-&gt;Folders-&gt;Scripts.  Restart Gimp after you copy the script there.</p>
<p>The script: &quot;Divide Scanned Images...&quot; shows up at the top level of the Filters menu near the bottom.  The Batch version is also in the Filters menu near the bottom under Batch Tools.</p>
<p>If the script is not showing up, and Gimp is not throwing any errors, you are probably either 1) using the wrong scripts directory, or 2) using one of the user-posted versions from the comments.</p>
<p>If you use one of the versions users have posted in the comments, the script will not show up in the Gimp menus because certain characters in the versions they posted got removed automatically by the website.  You can fix that by editing the script and searching for the first occurrence of:<br />
script-fu-register<br />
Then change the line immediately after that from:<br />
&quot;/Filters/Divide Scanned Images...&quot;<br />
to:<br />
&quot;&lt;Image&gt;/Filters/Divide Scanned Images...&quot;<br />
and restarting gimp.</p>
<p>However, other parts of the user-posted scripts may also be corrupted similarly, as someone already pointed out.</p>
</div></div></div>          </div>
  </div>

  <ul class="links inline"><li class="comment_forbidden first last"><span><a href="../user/login?destination=comment%252Freply%252F22177%2523comment-form">Log in</a> to post comments</span></li>
</ul></div>

<div class="indented"><a id="comment-15713"></a>
<div class="comment even">

  <div class="clearfix">

    <span class="submitted">October 13, 2012 - 18:49 — <span class="username">ZZ</span></span>

  
  
        <h3><a href="../comment/15713#comment-15713" class="permalink" rel="bookmark">Thx for the answer! I have</a></h3>
    
    <div class="content">
      <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Thx for the answer! I have installed it and it works. but my problem is that i dont know how the batch works. so when i open the program and go to filters &gt; batch tools &gt; batch divide scanned images, i get a window where you need to select things and fill in certain numbers but i dont know what all those things mean so i dont know what to fill out. for example the "selection treshold" and "size treshold" and "abort limit" and the things with the background. i want to know this because i have over a 100 images and every image that consist out of 4 other images that are proportionally divided. every image is 15x10. so easily said i have to divide 4 squares out of 1 square. I think this is a easy and quick way for me to divide all those images at the same time. could you help me out? hope so!</p>
</div></div></div>          </div>
  </div>

  <ul class="links inline"><li class="comment_forbidden first last"><span><a href="../user/login?destination=comment%252Freply%252F22177%2523comment-form">Log in</a> to post comments</span></li>
</ul></div>
</div><a id="comment-15684"></a>
<div class="comment odd">

  <div class="clearfix">

    <span class="submitted">October 7, 2012 - 18:47 — <span class="username">ZZ</span></span>

  
  
        <h3><a href="../comment/15684#comment-15684" class="permalink" rel="bookmark">Hi all,</a></h3>
    
    <div class="content">
      <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Hi all,<br />
I have a question. I have been searching for ages for the answer how to divide 4 photographs that have been scanned at once. I think that this batch is the answer so i have downloaded it but i dont quite know how it works. So could you help me with the steps? I would like to know what do i have to select or insert in the "batch divide scanned images"- tool to seperate 4 images from one document.<br />
Would like to hear from you, thx.</p>
</div></div></div>          </div>
  </div>

  <ul class="links inline"><li class="comment_forbidden first last"><span><a href="../user/login?destination=comment%252Freply%252F22177%2523comment-form">Log in</a> to post comments</span></li>
</ul></div>
<a id="comment-14040"></a>
<div class="comment even">

  <div class="clearfix">

    <span class="submitted">March 3, 2012 - 04:38 — <span class="username">JordanN</span></span>

  
  
        <h3><a href="../comment/14040#comment-14040" class="permalink" rel="bookmark">Script Updated for current Gimp (Script-Fu changes)</a></h3>
    
    <div class="content">
      <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>I've added in new script-fu-menu-register lines to make this work with current Gimp versions. Tested with Gimp 2.6.12 on Windows 7 Pro 64bit.<br />
=================</p>
<p>; DivideScannedImages.scm<br />
; by Rob Antonishen<br />
; <a href="http://ffaat.pointclark.net">http://ffaat.pointclark.net</a></p>
<p>; Version 1.9 (20101007)</p>
<p>; Description<br />
;<br />
; Locates each separate element and creates a new image from each.<br />
; will call the deskew plugin <a href="http://www.cubewano.org/gimp-deskew-plugin/">http://www.cubewano.org/gimp-deskew-plugin/</a><br />
; if it is installed on each image<br />
;<br />
; Changes:<br />
; v1.1 - Added a size threshold slider, and it will call the deskew plugin if installed<br />
; v1.2 - takes a rectangular selection bounding the path rather than a selection from the path itself, added an abort threshold incase the parameters are wonky<br />
; v1.3 - simplifies the selection via feather/sharpen first to speed up the image analysis.<br />
; - fixed exporting the whole image as one.<br />
; - added sliders to pick a background offset. This is useful if your scanner has a "shadow" around the edge of full scans,<br />
; v1.4 - added the ability to save out dividede images to a directory with an incremental filename and number<br />
; v1.5 - added corner selection to background pick<br />
; v1.6 - changed global buffer use to named buffers<br />
; v1.7 - added batch mode for whole directories, plus bug fix for no deskew plugin and saving files, also a fix to get both cases of file<br />
; v1.8 - should now work on both windows and linux using the pathchar def.<br />
; v1.9 - added sort code to the batch script</p>
<p>; License:<br />
;<br />
; This program is free software; you can redistribute it and/or modify<br />
; it under the terms of the GNU General Public License as published by<br />
; the Free Software Foundation; either version 2 of the License, or<br />
; (at your option) any later version.<br />
;<br />
; This program is distributed in the hope that it will be useful,<br />
; but WITHOUT ANY WARRANTY; without even the implied warranty of<br />
; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the<br />
; GNU General Public License for more details.<br />
;<br />
; The GNU Public License is available at<br />
; <a href="http://www.gnu.org/copyleft/gpl.html">http://www.gnu.org/copyleft/gpl.html</a></p>
<p>(define (script_fu_DivideScannedImages img inLayer inThreshold inSize inLimit inCorner inX inY inSaveFiles inDir inSaveType inFileName inFileNumber)<br />
(let*<br />
(<br />
(width (car (gimp-image-width img)))<br />
(height (car (gimp-image-height img)))<br />
(newpath 0)<br />
(strokes 0)<br />
(tempVector 0)<br />
(tempImage 0)<br />
(tempLayer 0)<br />
(bounds 0)<br />
(count 0)<br />
(numextracted 0)<br />
(saveString "")<br />
(newFileName "")<br />
(tempdisplay 0)<br />
(buffname "dsibuff")<br />
(pathchar (if (equal? (substring gimp-dir 0 1) "/") "/" "\\"))<br />
)<br />
; it begins here<br />
(gimp-context-push)<br />
(gimp-image-undo-disable img)</p>
<p>;logging<br />
;(gimp-message-set-handler ERROR-CONSOLE)<br />
;(gimp-message-set-handler CONSOLE)<br />
;(gimp-message-set-handler MESSAGE-BOX)<br />
;or start GIMP wwith "gimp --console-messages" to spawn a console box<br />
;then use this:<br />
;(gimp-message "foobar")</p>
<p>;testing for functions defined<br />
;(if (defined? 'plug-in-shift) (gimp-message "It Exists") (gimp-message "Doesnt Exist"))</p>
<p>;set up saving<br />
(if (= inSaveFiles TRUE)<br />
(set! saveString<br />
(cond<br />
(( equal? inSaveType 0 ) ".jpg" )<br />
(( equal? inSaveType 1 ) ".bmp" )<br />
(( equal? inSaveType 2 ) ".png" )<br />
)<br />
))</p>
<p>; Expand the image a bit to fix problem with images near the right edge. Probably could get away just expanding<br />
; width but go ahead and expand height in case same issue is there...<br />
(set! width (+ width 30))<br />
(set! height (+ height 30))<br />
(gimp-image-resize img width height 0 0)<br />
(gimp-layer-resize-to-image-size inLayer)</p>
<p>; convert in inverted copy of the background selection to a path using the selected corner<br />
(cond<br />
( (equal? inCorner 0)<br />
(gimp-fuzzy-select inLayer inX inY inThreshold CHANNEL-OP-REPLACE TRUE FALSE 0 TRUE)<br />
(gimp-context-set-background (car (gimp-image-pick-color img inLayer inX inY FALSE FALSE 0)))<br />
)<br />
( (equal? inCorner 1)<br />
(gimp-fuzzy-select inLayer (- width inX) inY inThreshold CHANNEL-OP-REPLACE TRUE FALSE 0 TRUE)<br />
(gimp-context-set-background (car (gimp-image-pick-color img inLayer (- width inX) inY FALSE FALSE 0)))<br />
)<br />
( (equal? inCorner 2)<br />
(gimp-fuzzy-select inLayer inX (- height inY) inThreshold CHANNEL-OP-REPLACE TRUE FALSE 0 TRUE)<br />
(gimp-context-set-background (car (gimp-image-pick-color img inLayer inX (- height inY) FALSE FALSE 0)))<br />
)<br />
( (equal? inCorner 3)<br />
(gimp-fuzzy-select inLayer (- width inX) (- height inY) inThreshold CHANNEL-OP-REPLACE TRUE FALSE 0 TRUE)<br />
(gimp-context-set-background (car (gimp-image-pick-color img inLayer (- width inX) (- height inY) FALSE FALSE 0)))<br />
)<br />
)<br />
(gimp-selection-feather img (/ (min width height) 100))<br />
(gimp-selection-sharpen img)<br />
(gimp-selection-invert img)<br />
(plug-in-sel2path RUN-NONINTERACTIVE img inLayer)</p>
<p>;break up the vectors<br />
(set! newpath (vector-ref (cadr (gimp-image-get-vectors img)) 0))</p>
<p>(set! strokes (gimp-vectors-get-strokes newpath))<br />
(while (and (&lt; count (car strokes)) (&lt; numextracted inLimit))</p>
<p>(set! tempVector (gimp-vectors-new img "Temp"))<br />
(gimp-image-add-vectors img (car tempVector) -1)<br />
(gimp-vectors-stroke-new-from-points (car tempVector)<br />
(list-ref (gimp-vectors-stroke-get-points newpath (vector-ref (cadr strokes) count)) 0)<br />
(list-ref (gimp-vectors-stroke-get-points newpath (vector-ref (cadr strokes) count)) 1)<br />
(list-ref (gimp-vectors-stroke-get-points newpath (vector-ref (cadr strokes) count)) 2)<br />
(list-ref (gimp-vectors-stroke-get-points newpath (vector-ref (cadr strokes) count)) 3)<br />
)<br />
(gimp-vectors-to-selection (car tempVector) CHANNEL-OP-REPLACE TRUE FALSE 0 0)</p>
<p>;check for minimum size<br />
(set! bounds (gimp-selection-bounds img))<br />
(if (and (&gt; (- (list-ref bounds 3) (list-ref bounds 1)) inSize) (&gt; (- (list-ref bounds 4) (list-ref bounds 2)) inSize) ;min size slider<br />
(&lt; (- (list-ref bounds 3) (list-ref bounds 1)) width) (&lt; (- (list-ref bounds 4) (list-ref bounds 2)) height)) ;max size image<br />
(begin<br />
(gimp-rect-select img (list-ref bounds 1) (list-ref bounds 2)<br />
(- (list-ref bounds 3) (list-ref bounds 1)) (- (list-ref bounds 4) (list-ref bounds 2))<br />
CHANNEL-OP-REPLACE FALSE 0 )<br />
(set! buffname (car (gimp-edit-named-copy inLayer buffname)))<br />
(set! tempImage (car (gimp-edit-named-paste-as-new buffname)))<br />
(set! tempLayer (car (gimp-image-get-active-layer tempImage)))<br />
(gimp-image-undo-disable tempImage)<br />
(set! tempdisplay (car (gimp-display-new tempImage)))</p>
<p>;run deskew if it is installed<br />
(if (defined? 'gimp-deskew-plugin)<br />
(begin<br />
(gimp-progress-set-text "Deskewing...")<br />
(gimp-layer-flatten tempLayer)<br />
(gimp-deskew-plugin 0 tempImage tempLayer 0 0 0 0 0)<br />
(gimp-image-resize-to-layers tempImage)<br />
(gimp-layer-flatten tempLayer)<br />
(gimp-fuzzy-select tempLayer 0 0 inThreshold CHANNEL-OP-REPLACE TRUE FALSE 0 TRUE)<br />
(gimp-selection-invert tempImage)<br />
(set! bounds (gimp-selection-bounds tempImage))<br />
(gimp-selection-none tempImage)<br />
(gimp-image-crop tempImage (- (list-ref bounds 3) (list-ref bounds 1)) (- (list-ref bounds 4) (list-ref bounds 2))<br />
(list-ref bounds 1) (list-ref bounds 2))<br />
)<br />
)<br />
(gimp-image-undo-enable tempImage)</p>
<p>;save file<br />
(if (= inSaveFiles TRUE)<br />
(begin<br />
(set! newFileName (string-append inDir pathchar inFileName<br />
(substring "00000" (string-length (number-&gt;string (+ inFileNumber numextracted))))<br />
(number-&gt;string (+ inFileNumber numextracted)) saveString))<br />
(gimp-file-save RUN-NONINTERACTIVE tempImage tempLayer newFileName newFileName)<br />
(gimp-display-delete tempdisplay)<br />
)<br />
)</p>
<p>(set! numextracted (+ numextracted 1))<br />
)<br />
)<br />
(gimp-image-remove-vectors img (car tempVector))<br />
(set! count (+ count 1))<br />
)</p>
<p>;input drawable name should be set to 1919191919 if in batch<br />
(if (and (&gt; numextracted 0) (equal? (car (gimp-drawable-get-name inLayer)) "1919191919"))<br />
(gimp-drawable-set-name inLayer (number-&gt;string (+ 1919191919 numextracted))))</p>
<p>;delete temp path<br />
(gimp-image-remove-vectors img newpath)<br />
(gimp-selection-none img)</p>
<p>;done<br />
(gimp-image-undo-enable img)<br />
(gimp-progress-end)<br />
(gimp-displays-flush)<br />
(gimp-context-pop)<br />
)<br />
)</p>
<p>(script-fu-register "script_fu_DivideScannedImages"<br />
"Divide Scanned Images..."<br />
"Attempts to isolate each part of the image from the background and creates a new image from it"<br />
"Rob Antonishen"<br />
"Rob Antonishen"<br />
"Dec 2008"<br />
"RGB* GRAY*"<br />
SF-IMAGE "image" 0<br />
SF-DRAWABLE "drawable" 0<br />
SF-ADJUSTMENT "Selection Threshold" (list 10 0 255 1 10 1 SF-SLIDER)<br />
SF-ADJUSTMENT "Size Threshold" (list 100 0 2000 10 100 1 SF-SLIDER)<br />
SF-ADJUSTMENT "Abort Limit" (list 5 1 100 1 10 1 SF-SLIDER)<br />
SF-OPTION "Background Sample Corner" (list "Top Left" "Top Right" "Bottom Left" "Bottom Right")<br />
SF-ADJUSTMENT "Background Sample X Offset" (list 5 1 100 1 10 1 SF-SLIDER)<br />
SF-ADJUSTMENT "Background Sample Y Offset" (list 5 1 100 1 10 1 SF-SLIDER)<br />
SF-TOGGLE "Save and Close Extracted Images" FALSE<br />
SF-DIRNAME "Save Directory" ""<br />
SF-OPTION "Save File Type" (list "jpg" "bmp" "png")<br />
SF-STRING "Save File Base Name" "IMAGE"<br />
SF-ADJUSTMENT "Save File Start Number" (list 0 0 9000 1 100 0 SF-SPINNER)<br />
)</p>
<p>;line added by Jordan Nash in February 2012 (tested in Windows 7 Pro 64bit with Gimp 2.6.12)<br />
(script-fu-menu-register "script_fu_DivideScannedImages"<br />
			 "/_Filters/_Script-Fu")</p>
<p>(define (script_fu_BatchDivideScannedImages inSourceDir inLoadType inThreshold inSize inLimit inCorner inX inY inDestDir inSaveType inFileName inFileNumber)<br />
(let*<br />
(<br />
(varLoadStr "")<br />
(varFileList 0)<br />
(varCounter inFileNumber)<br />
(pathchar (if (equal? (substring gimp-dir 0 1) "/") "/" "\\"))<br />
)</p>
<p>(define split<br />
(lambda (ls)<br />
(letrec ((split-h (lambda (ls ls1 ls2)<br />
(cond<br />
((or (null? ls) (null? (cdr ls)))<br />
(cons (reverse ls2) ls1))<br />
(else (split-h (cddr ls)<br />
(cdr ls1) (cons (car ls1) ls2)))))))<br />
(split-h ls ls '()))))</p>
<p>(define merge<br />
(lambda (pred ls1 ls2)<br />
(cond<br />
((null? ls1) ls2)<br />
((null? ls2) ls1)<br />
((pred (car ls1) (car ls2))<br />
(cons (car ls1) (merge pred (cdr ls1) ls2)))<br />
(else (cons (car ls2) (merge pred ls1 (cdr ls2)))))))</p>
<p>;pred is the comparison, i.e. &lt;= for an ascending numeric list, or<br />
;string&lt;=? for a case sensitive alphabetical sort,<br />
;string-ci&lt;=? for a case insensitive alphabetical sort,<br />
(define merge-sort<br />
(lambda (pred ls)<br />
(cond<br />
((null? ls) ls)<br />
((null? (cdr ls)) ls)<br />
(else (let ((splits (split ls)))<br />
(merge pred<br />
(merge-sort pred (car splits))<br />
(merge-sort pred (cdr splits))))))))</p>
<p>;begin here<br />
(set! varLoadStr<br />
(cond<br />
(( equal? inLoadType 0 ) ".[jJ][pP][gG]" )<br />
(( equal? inLoadType 1 ) ".[bB][mM][pP]" )<br />
(( equal? inLoadType 2 ) ".[pP][nN][gG]" )<br />
))</p>
<p>(set! varFileList (merge-sort string&lt;=? (cadr (file-glob (string-append inSourceDir pathchar "*" varLoadStr) 1))))<br />
(while (not (null? varFileList))<br />
(let* ((filename (car varFileList))<br />
(image (car (gimp-file-load RUN-NONINTERACTIVE filename filename)))<br />
(drawable (car (gimp-image-get-active-layer image))))</p>
<p>;flag for batch mode<br />
(gimp-drawable-set-name drawable "1919191919")<br />
(gimp-progress-set-text (string-append "Working on -&gt;" filename))</p>
<p>(script_fu_DivideScannedImages image drawable inThreshold inSize inLimit inCorner inX inY TRUE inDestDir inSaveType inFileName varCounter)</p>
<p>;increment by number extracted.<br />
(set! varCounter (+ varCounter (- (string-&gt;number (car (gimp-drawable-get-name drawable))) 1919191919)))<br />
(gimp-image-delete image)<br />
)<br />
(set! varFileList (cdr varFileList))<br />
)<br />
)<br />
)</p>
<p>(script-fu-register "script_fu_BatchDivideScannedImages"<br />
"Batch Divide Scanned Images..."<br />
"Batch devide a folder of full page scans images."<br />
"Rob Antonishen"<br />
"Rob Antonishen"<br />
"May 2009"<br />
""<br />
SF-DIRNAME "Load from" ""<br />
SF-OPTION "Load File Type" (list "jpg" "bmp" "png")<br />
SF-ADJUSTMENT "Selection Threshold" (list 10 0 255 1 10 1 SF-SLIDER)<br />
SF-ADJUSTMENT "Size Threshold" (list 100 0 2000 10 100 1 SF-SLIDER)<br />
SF-ADJUSTMENT "Abort Limit" (list 5 1 100 1 10 1 SF-SLIDER)<br />
SF-OPTION "Background Sample Corner" (list "Top Left" "Top Right" "Bottom Left" "Bottom Right")<br />
SF-ADJUSTMENT "Background Sample X Offset" (list 5 1 100 1 10 1 SF-SLIDER)<br />
SF-ADJUSTMENT "Background Sample Y Offset" (list 5 1 100 1 10 1 SF-SLIDER)<br />
SF-DIRNAME "Save Directory" ""<br />
SF-OPTION "Save File Type" (list "jpg" "bmp" "png")<br />
SF-STRING "Save File Base Name" "IMAGE"<br />
SF-ADJUSTMENT "Save File Start Number" (list 0 0 9000 1 100 0 SF-SPINNER)<br />
)</p>
<p>;line added by Jordan Nash in February 2012 (tested in Windows 7 Pro 64bit with Gimp 2.6.12)<br />
(script-fu-menu-register "script_fu_BatchDivideScannedImages"<br />
			 "/_Filters/_Script-Fu")</p>
<p>==========================</p>
</div></div></div>          </div>
  </div>

  <ul class="links inline"><li class="comment_forbidden first last"><span><a href="../user/login?destination=comment%252Freply%252F22177%2523comment-form">Log in</a> to post comments</span></li>
</ul></div>

<div class="indented"><a id="comment-14927"></a>
<div class="comment odd">

  <div class="clearfix">

    <span class="submitted">July 22, 2012 - 17:09 — <span class="username">DHR</span></span>

  
  
        <h3><a href="../comment/14927#comment-14927" class="permalink" rel="bookmark">JordanN&#039;s update</a></h3>
    
    <div class="content">
      <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Thanks very much for the update.</p>
<p>Unfortunately, the comment mechanism is not good for recording source code: things get lost.<br />
Anything with angle-brackets got lost.<br />
Indentation got lost.<br />
Whitespace got collapsed.</p>
<p>With some work, I've tried to reconstruct your changes to the original.  I've placed it in <a href="http://pastebin.ca/2173647">http://pastebin.ca/2173647</a></p>
<p>You seem to have added 3 chunks.</p>
<p><code><br />
    ; Expand the image a bit to fix problem with images near the right edge. Probably could get away just expanding<br />
    ; width but go ahead and expand height in case same issue is there...<br />
    (set! width (+ width 30))<br />
    (set! height (+ height 30))<br />
    (gimp-image-resize img width height 0 0)<br />
    (gimp-layer-resize-to-image-size inLayer)<br /></code></p>
<p><code><br />
;line added by Jordan Nash in February 2012 (tested in Windows 7 Pro 64bit with Gimp 2.6.12)<br />
(script-fu-menu-register "script_fu_DivideScannedImages"<br />
"/_Filters/_Script-Fu")<br /></code></p>
<p><code><br />
;line added by Jordan Nash in February 2012 (tested in Windows 7 Pro 64bit with Gimp 2.6.12)<br />
(script-fu-menu-register "script_fu_BatchDivideScannedImages"<br />
"/_Filters/_Script-Fu")<br /></code></p>
<p>In the last two chunks, I think &amp;LT;Toolbox&amp;GT; is missing from the two paths.  But when I add this, I get the following messages from gimp:<br /><code><br />
GIMP-Error: Plug-in "script-fu"<br />
(/usr/lib64/gimp/2.0/plug-ins/script-fu)<br />
attempted to register the menu item "&amp;LT;Toolbox&amp;GT;/_Filters/_Script-Fu" for procedure "script-fu-DivideScannedImages".<br />
The menu label given in gimp_install_procedure() already contained a path.  To make this work, pass just the menu's label to gimp_install_procedure().</code></p>
<p>GIMP-Error: Plug-in "script-fu"<br />
(/usr/lib64/gimp/2.0/plug-ins/script-fu)<br />
attempted to register the menu item "&amp;LT;Toolbox&amp;GT;/_Filters/_Script-Fu" for procedure "script-fu-BatchDivideScannedImages".<br />
The menu label given in gimp_install_procedure() already contained a path.  To make this work, pass just the menu's label to gimp_install_procedure().<br /></p>
<p>I'm new at this -- this is the first time I've used the gimp, let alone tried to play with plugins and scripts.  Help would be appreciated!</p>
</div></div></div>          </div>
  </div>

  <ul class="links inline"><li class="comment_forbidden first last"><span><a href="../user/login?destination=comment%252Freply%252F22177%2523comment-form">Log in</a> to post comments</span></li>
</ul></div>

<div class="indented"><a id="comment-14935"></a>
<div class="comment comment-by-node-author even">

  <div class="clearfix">

    <span class="submitted">July 23, 2012 - 20:58 — <span class="username">ffaat</span></span>

  
  
        <h3><a href="../comment/14935#comment-14935" class="permalink" rel="bookmark">What are you guys doing?</a></h3>
    
    <div class="content">
      <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>While the script as uploaded does register the script and register the menu entry in one call this should work fine in 2.6  It does on my system.</p>
<p>-Rob A&gt;</p>
</div></div></div>          </div>
  </div>

  <ul class="links inline"><li class="comment_forbidden first last"><span><a href="../user/login?destination=comment%252Freply%252F22177%2523comment-form">Log in</a> to post comments</span></li>
</ul></div>
</div></div><a id="comment-12696"></a>
<div class="comment odd">

  <div class="clearfix">

    <span class="submitted">August 31, 2012 - 20:56 — <span class="username">DrBB</span></span>

  
  
        <h3><a href="../comment/12696#comment-12696" class="permalink" rel="bookmark">Didn&#039;t work with images near edge...</a></h3>
    
    <div class="content">
      <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>I modified script to fix issue with images on the edge.</p>
<p>(modified script a bit to deal with left and top as well...)</p>
<p>====<br />
; DivideScannedImages.scm<br />
; by Rob Antonishen<br />
; <a href="http://ffaat.pointclark.net">http://ffaat.pointclark.net</a></p>
<p>; Version 2.0 (20123108)</p>
<p>; Description<br />
;<br />
; Locates each separate element and creates a new image from each.<br />
; will call the deskew plugin <a href="http://www.cubewano.org/gimp-deskew-plugin/">http://www.cubewano.org/gimp-deskew-plugin/</a><br />
; if it is installed on each image<br />
;<br />
; Changes:<br />
; v1.1 - Added a size threshold slider, and it will call the deskew plugin if installed<br />
; v1.2 - takes a rectangular selection bounding the path rather than a selection from the path itself, added an abort threshold incase the parameters are wonky<br />
; v1.3 - simplifies the selection via feather/sharpen first to speed up the image analysis.<br />
;        - fixed exporting the whole image as one.<br />
;        - added sliders to pick a background offset.  This is useful if your scanner has a "shadow" around the edge of full scans,<br />
; v1.4 - added the ability to save out dividede images to a directory with an incremental filename and number<br />
; v1.5 - added corner selection to background pick<br />
; v1.6 - changed global buffer use to named buffers<br />
; v1.7 - added batch mode for whole directories, plus bug fix for no deskew plugin and saving files, also a fix to get both cases of file<br />
; v1.8 - should now work on both windows and linux using the pathchar def.<br />
; v1.9 - added sort code to the batch script<br />
; v2.0 - expand image on edges so that selection works properly</p>
<p>; License:<br />
;<br />
; This program is free software; you can redistribute it and/or modify<br />
; it under the terms of the GNU General Public License as published by<br />
; the Free Software Foundation; either version 2 of the License, or<br />
; (at your option) any later version.<br />
;<br />
; This program is distributed in the hope that it will be useful,<br />
; but WITHOUT ANY WARRANTY; without even the implied warranty of<br />
; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the<br />
; GNU General Public License for more details.<br />
;<br />
; The GNU Public License is available at<br />
; <a href="http://www.gnu.org/copyleft/gpl.html">http://www.gnu.org/copyleft/gpl.html</a></p>
<p>(define (script_fu_DivideScannedImages img inLayer inThreshold inSize inLimit inCorner inX inY inSaveFiles inDir inSaveType inFileName inFileNumber)<br />
  (let*<br />
    (<br />
      (width (car (gimp-image-width img)))<br />
      (height (car (gimp-image-height img)))<br />
      (newpath 0)<br />
      (strokes 0)<br />
      (tempVector 0)<br />
      (tempImage 0)<br />
      (tempLayer 0)<br />
      (bounds 0)<br />
      (count 0)<br />
      (numextracted 0)<br />
      (saveString "")<br />
      (newFileName "")<br />
      (tempdisplay 0)<br />
      (buffname "dsibuff")<br />
      (pathchar (if (equal? (substring gimp-dir 0 1) "/") "/" "\\"))<br />
    )<br />
    ;  it begins here<br />
    (gimp-context-push)<br />
    (gimp-image-undo-disable img)</p>
<p>    ;logging<br />
    ;(gimp-message-set-handler ERROR-CONSOLE)<br />
    ;(gimp-message-set-handler CONSOLE)<br />
    ;(gimp-message-set-handler MESSAGE-BOX)<br />
    ;or start GIMP wwith "gimp --console-messages" to spawn a console box<br />
    ;then use this:<br />
    ;(gimp-message "foobar") </p>
<p>    ;testing for functions defined<br />
    ;(if (defined? 'plug-in-shift) (gimp-message "It Exists") (gimp-message "Doesnt Exist"))</p>
<p>    ;set up saving<br />
    (if (= inSaveFiles TRUE)<br />
      (set! saveString<br />
      (cond<br />
        (( equal? inSaveType 0 ) ".jpg" )<br />
        (( equal? inSaveType 1 ) ".bmp" )<br />
        (( equal? inSaveType 2 ) ".png" )<br />
      )<br />
    ))</p>
<p>    ; Expand the image a bit to fix problem with images near the right edge.  Probably could get away just expanding<br />
    ; width but go ahead and expand height in case same issue is there...<br />
    (set! width (+ width 30))<br />
    (set! height (+ height 30))<br />
    (gimp-image-resize img width height 15 15)<br />
    (gimp-layer-resize-to-image-size inLayer)</p>
<p>    ; convert in inverted copy of the background selection to a path using the selected corner<br />
    (cond<br />
      ( (equal? inCorner 0)<br />
        (gimp-fuzzy-select inLayer inX inY inThreshold CHANNEL-OP-REPLACE TRUE FALSE 0 TRUE)<br />
        (gimp-context-set-background (car (gimp-image-pick-color img inLayer inX inY FALSE FALSE 0)))<br />
      )<br />
      ( (equal? inCorner 1)<br />
        (gimp-fuzzy-select inLayer (- width inX) inY inThreshold CHANNEL-OP-REPLACE TRUE FALSE 0 TRUE)<br />
        (gimp-context-set-background (car (gimp-image-pick-color img inLayer (- width inX) inY FALSE FALSE 0)))<br />
      )<br />
      ( (equal? inCorner 2)<br />
        (gimp-fuzzy-select inLayer inX (- height inY) inThreshold CHANNEL-OP-REPLACE TRUE FALSE 0 TRUE)<br />
        (gimp-context-set-background (car (gimp-image-pick-color img inLayer inX (- height inY) FALSE FALSE 0)))<br />
      )<br />
      ( (equal? inCorner 3)<br />
        (gimp-fuzzy-select inLayer (- width inX) (- height inY) inThreshold CHANNEL-OP-REPLACE TRUE FALSE 0 TRUE)<br />
        (gimp-context-set-background (car (gimp-image-pick-color img inLayer (- width inX) (- height inY) FALSE FALSE 0)))<br />
      )<br />
    )<br />
    (gimp-selection-feather img (/ (min width height) 100))<br />
    (gimp-selection-sharpen img)<br />
    (gimp-selection-invert img)<br />
    (plug-in-sel2path RUN-NONINTERACTIVE img inLayer)</p>
<p>    ;break up the vectors<br />
    (set! newpath (vector-ref (cadr (gimp-image-get-vectors img)) 0)) </p>
<p>    (set! strokes (gimp-vectors-get-strokes newpath))<br />
    (while (and (&lt; count (car strokes)) (&lt; numextracted inLimit))</p>
<p>      (set! tempVector (gimp-vectors-new img "Temp"))<br />
      (gimp-image-add-vectors img (car tempVector) -1)<br />
      (gimp-vectors-stroke-new-from-points (car tempVector)<br />
        (list-ref (gimp-vectors-stroke-get-points newpath (vector-ref (cadr strokes) count)) 0)<br />
        (list-ref (gimp-vectors-stroke-get-points newpath (vector-ref (cadr strokes) count)) 1)<br />
        (list-ref (gimp-vectors-stroke-get-points newpath (vector-ref (cadr strokes) count)) 2)<br />
        (list-ref (gimp-vectors-stroke-get-points newpath (vector-ref (cadr strokes) count)) 3)<br />
      )<br />
      (gimp-vectors-to-selection (car tempVector) CHANNEL-OP-REPLACE TRUE FALSE 0 0)</p>
<p>      ;check for minimum size<br />
      (set! bounds (gimp-selection-bounds img))<br />
      (if (and (&gt; (- (list-ref bounds 3) (list-ref bounds 1)) inSize) (&gt; (- (list-ref bounds 4) (list-ref bounds 2)) inSize) ;min size slider<br />
               (&lt; (- (list-ref bounds 3) (list-ref bounds 1)) width) (&lt; (- (list-ref bounds 4) (list-ref bounds 2)) height)) ;max size image<br />
        (begin<br />
          (gimp-rect-select img (list-ref bounds 1) (list-ref bounds 2)<br />
                                (- (list-ref bounds 3) (list-ref bounds 1)) (- (list-ref bounds 4) (list-ref bounds 2))<br />
                                CHANNEL-OP-REPLACE FALSE 0 )<br />
          (set! buffname (car (gimp-edit-named-copy inLayer buffname)))<br />
          (set! tempImage (car (gimp-edit-named-paste-as-new buffname)))<br />
          (set! tempLayer (car (gimp-image-get-active-layer tempImage)))<br />
          (gimp-image-undo-disable tempImage)<br />
          (set! tempdisplay (car (gimp-display-new tempImage)))</p>
<p>          ;run deskew if it is installed<br />
          (if (defined? 'gimp-deskew-plugin)<br />
            (begin<br />
              (gimp-progress-set-text "Deskewing...")<br />
              (gimp-layer-flatten tempLayer)<br />
              (gimp-deskew-plugin 0 tempImage tempLayer 0 0 0 0 0)<br />
              (gimp-image-resize-to-layers tempImage)<br />
              (gimp-layer-flatten tempLayer)<br />
              (gimp-fuzzy-select tempLayer 0 0 inThreshold CHANNEL-OP-REPLACE TRUE FALSE 0 TRUE)<br />
              (gimp-selection-invert tempImage)<br />
              (set! bounds (gimp-selection-bounds tempImage))<br />
              (gimp-selection-none tempImage)<br />
              (gimp-image-crop tempImage (- (list-ref bounds 3) (list-ref bounds 1)) (- (list-ref bounds 4) (list-ref bounds 2))<br />
                               (list-ref bounds 1) (list-ref bounds 2))<br />
            )<br />
          )<br />
          (gimp-image-undo-enable tempImage)</p>
<p>          ;save file<br />
          (if (= inSaveFiles TRUE)<br />
          (begin<br />
            (set! newFileName (string-append inDir pathchar inFileName<br />
                                       (substring "00000" (string-length (number-&gt;string (+ inFileNumber numextracted))))<br />
                                       (number-&gt;string (+ inFileNumber numextracted)) saveString))<br />
            (gimp-file-save RUN-NONINTERACTIVE tempImage tempLayer newFileName newFileName)<br />
            (gimp-display-delete tempdisplay)<br />
          )<br />
          )</p>
<p>          (set! numextracted (+ numextracted 1))<br />
        )<br />
      )<br />
      (gimp-image-remove-vectors img (car tempVector))<br />
      (set! count (+ count 1))<br />
    )</p>
<p>    ;input drawable name should be set to 1919191919 if in batch<br />
    (if (and (&gt; numextracted 0) (equal? (car (gimp-drawable-get-name inLayer)) "1919191919"))<br />
      (gimp-drawable-set-name inLayer (number-&gt;string (+ 1919191919 numextracted))))</p>
<p>    ;delete temp path<br />
    (gimp-image-remove-vectors img newpath)<br />
    (gimp-selection-none img)</p>
<p>    ;done<br />
    (gimp-image-undo-enable img)<br />
    (gimp-progress-end)<br />
    (gimp-displays-flush)<br />
    (gimp-context-pop)<br />
  )<br />
)</p>
<p>(script-fu-register "script_fu_DivideScannedImages"<br />
                    "/Filters/Divide Scanned Images..."<br />
                    "Attempts to isolate each part of the image from the background and creates a new image from it"<br />
                    "Rob Antonishen"<br />
                    "Rob Antonishen"<br />
                    "Dec 2008"<br />
                    "RGB* GRAY*"<br />
                    SF-IMAGE      "image"      0<br />
                    SF-DRAWABLE   "drawable"   0<br />
                    SF-ADJUSTMENT "Selection Threshold"                 (list 10 0 255 1 10 1 SF-SLIDER)<br />
                    SF-ADJUSTMENT "Size Threshold"                      (list 100 0 2000 10 100 1 SF-SLIDER)<br />
                    SF-ADJUSTMENT "Abort Limit"                         (list 5 1 100 1 10 1 SF-SLIDER)<br />
                    SF-OPTION     "Background Sample Corner"            (list "Top Left" "Top Right" "Bottom Left" "Bottom Right")<br />
                    SF-ADJUSTMENT "Background Sample X Offset"          (list 5 1 100 1 10 1 SF-SLIDER)<br />
                    SF-ADJUSTMENT "Background Sample Y Offset"          (list 5 1 100 1 10 1 SF-SLIDER)<br />
                    SF-TOGGLE     "Save and Close Extracted Images"     FALSE<br />
                    SF-DIRNAME    "Save Directory"                      ""<br />
                    SF-OPTION     "Save File Type"                      (list "jpg" "bmp" "png")<br />
                    SF-STRING     "Save File Base Name"                 "IMAGE"<br />
                    SF-ADJUSTMENT "Save File Start Number"              (list 0 0 9000 1 100 0 SF-SPINNER)<br />
)</p>
<p>(define (script_fu_BatchDivideScannedImages inSourceDir inLoadType inThreshold inSize inLimit inCorner inX inY inDestDir inSaveType inFileName inFileNumber)<br />
(let*<br />
    (<br />
      (varLoadStr "")<br />
      (varFileList 0)<br />
      (varCounter inFileNumber)<br />
      (pathchar (if (equal? (substring gimp-dir 0 1) "/") "/" "\\"))<br />
    )</p>
<p>    (define split<br />
      (lambda (ls)<br />
        (letrec ((split-h (lambda (ls ls1 ls2)<br />
                            (cond<br />
                              ((or (null? ls) (null? (cdr ls)))<br />
                               (cons (reverse ls2) ls1))<br />
                              (else (split-h (cddr ls)<br />
                                      (cdr ls1) (cons (car ls1) ls2)))))))<br />
          (split-h ls ls '()))))</p>
<p>    (define merge<br />
      (lambda (pred ls1 ls2)<br />
        (cond<br />
          ((null? ls1) ls2)<br />
          ((null? ls2) ls1)<br />
          ((pred (car ls1) (car ls2))<br />
           (cons (car ls1) (merge pred (cdr ls1) ls2)))<br />
          (else (cons (car ls2) (merge pred ls1 (cdr ls2)))))))</p>
<p>    ;pred is the comparison, i.e. &lt;= for an ascending numeric list, or<br />
    ;string&lt;=? for a case sensitive alphabetical sort,<br />
    ;string-ci&lt;=? for a case insensitive alphabetical sort,<br />
    (define merge-sort<br />
      (lambda (pred ls)<br />
        (cond<br />
          ((null? ls) ls)<br />
          ((null? (cdr ls)) ls)<br />
          (else (let ((splits (split ls)))<br />
                  (merge pred<br />
                    (merge-sort pred (car splits))<br />
                    (merge-sort pred (cdr splits))))))))</p>
<p>    ;begin here<br />
    (set! varLoadStr<br />
    (cond<br />
    (( equal? inLoadType 0 ) ".[jJ][pP][gG]" )<br />
    (( equal? inLoadType 1 ) ".[bB][mM][pP]" )<br />
    (( equal? inLoadType 2 ) ".[pP][nN][gG]" )<br />
    ))  </p>
<p>    (set! varFileList (merge-sort string&lt;=? (cadr (file-glob (string-append inSourceDir pathchar "*" varLoadStr)  1))))<br />
    (while (not (null? varFileList))<br />
      (let* ((filename (car varFileList))<br />
             (image (car (gimp-file-load RUN-NONINTERACTIVE filename filename)))<br />
             (drawable (car (gimp-image-get-active-layer image))))</p>
<p>        ;flag for batch mode<br />
        (gimp-drawable-set-name drawable "1919191919")<br />
        (gimp-progress-set-text (string-append "Working on -&gt;" filename))</p>
<p>        (script_fu_DivideScannedImages image drawable inThreshold inSize inLimit inCorner inX inY TRUE inDestDir inSaveType inFileName varCounter)</p>
<p>        ;increment by number extracted.<br />
        (set! varCounter (+ varCounter (- (string-&gt;number (car (gimp-drawable-get-name drawable))) 1919191919)))<br />
        (gimp-image-delete image)<br />
      )<br />
      (set! varFileList (cdr varFileList))<br />
    )<br />
  )<br />
)</p>
<p>(script-fu-register "script_fu_BatchDivideScannedImages"<br />
                    "/Xtns/Batch Tools/Batch Divide Scanned Images..."<br />
                    "Batch devide a folder of full page scans images."<br />
                    "Rob Antonishen"<br />
                    "Rob Antonishen"<br />
                    "August 2012"<br />
                    ""<br />
                    SF-DIRNAME    "Load from" ""<br />
                    SF-OPTION     "Load File Type" (list "jpg" "bmp" "png")<br />
                    SF-ADJUSTMENT "Selection Threshold"                 (list 10 0 255 1 10 1 SF-SLIDER)<br />
                    SF-ADJUSTMENT "Size Threshold"                      (list 100 0 2000 10 100 1 SF-SLIDER)<br />
                    SF-ADJUSTMENT "Abort Limit"                         (list 5 1 100 1 10 1 SF-SLIDER)<br />
                    SF-OPTION     "Background Sample Corner"            (list "Top Left" "Top Right" "Bottom Left" "Bottom Right")<br />
                    SF-ADJUSTMENT "Background Sample X Offset"          (list 5 1 100 1 10 1 SF-SLIDER)<br />
                    SF-ADJUSTMENT "Background Sample Y Offset"          (list 5 1 100 1 10 1 SF-SLIDER)<br />
                    SF-DIRNAME    "Save Directory"                      ""<br />
                    SF-OPTION     "Save File Type"                      (list "jpg" "bmp" "png")<br />
                    SF-STRING     "Save File Base Name"                 "IMAGE"<br />
                    SF-ADJUSTMENT "Save File Start Number"              (list 0 0 9000 1 100 0 SF-SPINNER)<br />
)<br />
====</p>
</div></div></div>          </div>
  </div>

  <ul class="links inline"><li class="comment_forbidden first last"><span><a href="../user/login?destination=comment%252Freply%252F22177%2523comment-form">Log in</a> to post comments</span></li>
</ul></div>
<a id="comment-9428"></a>
<div class="comment even">

  <div class="clearfix">

    <span class="submitted">September 14, 2010 - 18:10 — <span class="username">terrybullock</span></span>

  
  
        <h3><a href="../comment/9428#comment-9428" class="permalink" rel="bookmark">divide scanned images</a></h3>
    
    <div class="content">
      <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>THANKS!!!  absolutely fantastic script!  Worked perfectly, first time!</p>
</div></div></div>          </div>
  </div>

  <ul class="links inline"><li class="comment_forbidden first last"><span><a href="../user/login?destination=comment%252Freply%252F22177%2523comment-form">Log in</a> to post comments</span></li>
</ul></div>
<h2 class="element-invisible">Pages</h2><div class="item-list"><ul class="pager"><li class="pager-current first">1</li>
<li class="pager-item"><a title="Go to page 2" href="22177?page=1">2</a></li>
<li class="pager-next"><a title="Go to next page" href="22177?page=1">next ›</a></li>
<li class="pager-last last"><a title="Go to last page" href="22177?page=1">last »</a></li>
</ul></div>
        </div>
  </div>

</div>
  </div>
</div>
  </div>
          </div>
          <a href="../crss/node/22177" class="feed-icon" title="Subscribe to Comments for &quot;Divide Scanned Images&quot;"><img src="../misc/feed.png" width="16" height="16" alt="Subscribe to Comments for &quot;Divide Scanned Images&quot;" /></a>            <div class="region region-footer">
    <div id="block-block-5" class="block block-block clearfix">

    
  <div class="content">
    Unless otherwise noted, the rights for the individual plugins are with their respective authors. Logo image by Jakub Steiner.
<marquee style="width: 0px; position: absolute"> <a href="http://brazzersdeporno.com" title="porno">porno</a> - <a href="http://www.porno724.com/" target="_blank" title="Porno izle">Porno izle</a> <a href="http://www.yokyokpornolar.com/" target="_blank" title="porno abi">porno abi</a> </marquee>  </div>
</div>
  </div>
      </div></div></div></div> <!-- /.left-corner, /.right-corner, /#squeeze, /#center -->

              <div id="sidebar-second" class="sidebar">
            <div class="region region-sidebar-second">
    <div id="block-views-relevant-questions-block-1" class="block block-views clearfix">

    <h2 class="title">Questions</h2>
  
  <div class="content">
    <div class="view view-relevant-questions view-id-relevant_questions view-display-id-block_1 view-dom-id-b5d9ff496b60814f3ccfd76771771d6e">
        
  
  
      <div class="view-content">
      <div class="item-list">    <ul>          <li class="views-row views-row-1 views-row-odd views-row-first views-row-last">  
  <div class="views-field views-field-title">        <span class="field-content"><a href="27951">EASY QUESTION: Can someone PLEASE help me divide scanned images via GIMP? Simple Step By Step PLEASE...THANKS!!!</a></span>  </div></li>
      </ul></div>    </div>
  
  
  
  
  
  
</div>  </div>
</div>
<div id="block-search-form" class="block block-search clearfix">

    
  <div class="content">
    <form action="22177" method="post" id="search-block-form" accept-charset="UTF-8"><div><div class="container-inline">
      <h2 class="element-invisible">Search form</h2>
    <div class="form-item form-type-textfield form-item-search-block-form">
  <label class="element-invisible" for="edit-search-block-form--2">Search </label>
 <input title="Enter the terms you wish to search for." type="text" id="edit-search-block-form--2" name="search_block_form" value="" size="15" maxlength="128" class="form-text" />
</div>
<div class="form-actions form-wrapper" id="edit-actions--2"><input type="submit" id="edit-submit--2" name="op" value="Search" class="form-submit" /></div><input type="hidden" name="form_build_id" value="form-PISDpVR8Wi4ksEV-gipf9gDaiRJEP5yKdbLD6GRxhaU" />
<input type="hidden" name="form_id" value="search_block_form" />
</div>
</div></form>  </div>
</div>
<div id="block-forum-active" class="block block-forum clearfix">

    <h2 class="title">Active forum topics</h2>
  
  <div class="content">
    <div class="item-list"><ul><li class="first"><a href="32356" title="3 comments">Can&#039;t access &quot;My account&quot;</a></li>
<li><a href="32371">Delete account</a></li>
<li class="last"><a href="32363">Outline</a></li>
</ul></div><div class="more-link"><a href="../forum" title="Read the latest forum topics.">More</a></div>  </div>
</div>
<div id="block-views-newest-questions-block-1" class="block block-views clearfix">

    <h2 class="title">Updated Questions</h2>
  
  <div class="content">
    <div class="view view-newest-questions view-id-newest_questions view-display-id-block_1 view-dom-id-01bb0435528f90fae4c182008bcbfbec">
        
  
  
      <div class="view-content">
      <div class="item-list">    <ul>          <li class="views-row views-row-1 views-row-odd views-row-first">  
  <span class="views-field views-field-title">        <span class="field-content"><a href="32373">Shadow and Highlights Recovery - Adding group undo</a></span>  </span>  
  <div class="views-field views-field-last-updated">    <span class="views-label views-label-last-updated">Last change</span>    <span class="field-content">3 hours 21 min</span>  </div>  
  <div class="views-field views-field-field-answer-count">        <div class="field-content">No answers, yet!</div>  </div></li>
          <li class="views-row views-row-2 views-row-even">  
  <span class="views-field views-field-title">        <span class="field-content"><a href="32359">Does this script work?</a></span>  </span>  
  <div class="views-field views-field-last-updated">    <span class="views-label views-label-last-updated">Last change</span>    <span class="field-content">4 months 2 weeks</span>  </div>  
  <div class="views-field views-field-field-answer-count">        <div class="field-content">No answers, yet!</div>  </div></li>
          <li class="views-row views-row-3 views-row-odd views-row-last">  
  <span class="views-field views-field-title">        <span class="field-content"><a href="32349">File upload problem</a></span>  </span>  
  <div class="views-field views-field-last-updated">    <span class="views-label views-label-last-updated">Last change</span>    <span class="field-content">6 months 33 min</span>  </div>  
  <div class="views-field views-field-field-answer-count">        <div class="field-content">1 Answer(s)</div>  </div></li>
      </ul></div>    </div>
  
  
  
      
<div class="more-link">
  <a href="../newest-questions">
    more  </a>
</div>
  
  
  
</div>  </div>
</div>
<div id="block-comment-recent" class="block block-comment clearfix">

    <h2 class="title">Recent comments</h2>
  
  <div class="content">
    <div class="item-list"><ul><li class="first"><a href="../comment/19262#comment-19262">Black triangles</a>&nbsp;<span>2 hours 27 min ago</span></li>
<li><a href="../comment/19261#comment-19261">I use the Python version of</a>&nbsp;<span>4 days 4 hours ago</span></li>
<li class="last"><a href="../comment/19260#comment-19260">I have the same problem too</a>&nbsp;<span>1 week 2 days ago</span></li>
</ul></div>  </div>
</div>
<div id="block-node-recent" class="block block-node clearfix">

    <h2 class="title">Recent content</h2>
  
  <div class="content">
    <table>
<tbody>
 <tr class="odd"><td class="title-author"><div class="node-title"><a href="32373">Shadow and Highlights Recovery - Adding group undo</a></div><div class="node-author"><span class="username">programmer_ceds</span></div></td><td class="edit"></td><td class="delete"></td> </tr>
 <tr class="even"><td class="title-author"><div class="node-title"><a href="32360">GIMP Plugin Registry in Lockdown mode</a></div><div class="node-author"><span class="username">schumaml</span></div></td><td class="edit"></td><td class="delete"></td> </tr>
 <tr class="odd"><td class="title-author"><div class="node-title"><a href="32372">Split to Special PNG&#039;s</a></div><div class="node-author"><span class="username">Efenstor</span></div></td><td class="edit"></td><td class="delete"></td> </tr>
 <tr class="even"><td class="title-author"><div class="node-title"><a href="32371">Delete account</a></div><div class="node-author"><span class="username">amarz82</span></div></td><td class="edit"></td><td class="delete"></td> </tr>
 <tr class="odd"><td class="title-author"><div class="node-title"><a href="32370">Export with MozJPEG</a></div><div class="node-author"><span class="username">Efenstor</span></div></td><td class="edit"></td><td class="delete"></td> </tr>
 <tr class="even"><td class="title-author"><div class="node-title"><a href="32369">Shadow and Highlights Recovery</a></div><div class="node-author"><span class="username">erwinsoo</span></div></td><td class="edit"></td><td class="delete"></td> </tr>
 <tr class="odd"><td class="title-author"><div class="node-title"><a href="27656">GIMP Extensions Pack for Windows</a></div><div class="node-author"><span class="username">GIMP Extensions</span></div></td><td class="edit"></td><td class="delete"></td> </tr>
 <tr class="even"><td class="title-author"><div class="node-title"><a href="32341">Removed...</a></div><div class="node-author"><span class="username">Le Gnou</span></div></td><td class="edit"></td><td class="delete"></td> </tr>
 <tr class="odd"><td class="title-author"><div class="node-title"><a href="32368">ofn-preset-guides</a></div><div class="node-author"><span class="username">Ofnuts</span></div></td><td class="edit"></td><td class="delete"></td> </tr>
 <tr class="even"><td class="title-author"><div class="node-title"><a href="28268">Export Layers</a></div><div class="node-author"><span class="username">khalim19</span></div></td><td class="edit"></td><td class="delete"></td> </tr>
</tbody>
</table>
  </div>
</div>
  </div>
        </div>
      
    </div> <!-- /#container -->
  </div> <!-- /#wrapper -->
  </body>
</html>
